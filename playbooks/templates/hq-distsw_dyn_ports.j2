service timestamps debug datetime msec
service timestamps log datetime msec
service password-encryption
service compress-config
!
hostname {{ ansible_hostname }}
!
boot-start-marker
boot-end-marker
!
!
enable secret {{ device_enable_secret }}
!
username {{ device_ssh_user }} privilege 15 secret {{ device_ssh_password }}
aaa new-model
!
!
aaa authentication login default local
aaa authorization exec default local 
!
!
!
!
!
aaa session-id common
clock timezone {{ time_zone }}
clock summer-time CET recurring {{ time_zone_st_start}} {{ time_zone_st_end }}
no ip routing
!
no ip cef
!
!
no ip domain-lookup
ip domain-name {{ domain_name }}
login on-failure log
login on-success log
no ipv6 cef
ipv6 multicast rpf use-bgp
!
!
!
!
!
!
!
spanning-tree mode pvst
spanning-tree extend system-id
!
!
!
!
vlan internal allocation policy ascending
!
ip ssh maxstartups 4
ip ssh time-out 60
ip ssh authentication-retries {{ ssh_max_auth }}
ip ssh source-interface {{ management_interface }}
ip ssh version {{ ssh_version }}
! 
!
!         
!
!
!
!
!
!
interface Loopback0
 no ip address
!
{%- for vlan in access_ports %}
  {%- for sw_module in access_ports[vlan] %}
    {%- for int_range in access_ports[vlan][sw_module] %}
      {%- for x in range(int_range[0],int_range[1]) %}
 !
 interface {{ sw_module }}/{{ x }}
 {% if vlan == 999 -%}
  description NotInUse
  shutdown
  {% endif -%}
  {% if vlan == 10 -%}
  switchport voice vlan 20
  {% endif -%}
  switchport mode access
  switchport access vlan {{ vlan }}
  spanning-tree portfast
      {% endfor -%}
    {% endfor -%}
  {% endfor -%}
{% endfor -%}
!
interface Ethernet7/3
 duplex auto
!         
interface Vlan1
 ip address 10.0.10.10 255.255.255.0
 no ip route-cache
!
ip default-gateway 10.0.10.254
!
no ip http server
!
!
logging trap notifications
logging source-interface {{ management_interface }}
logging host {{ syslog_server }}
!
!
snmp-server community {{ snmp_ro_community }} RO
snmp-server trap-source {{ management_interface }}
snmp-server contact {{ snmp_contact }}
{% for server in snmp_servers %}
snmp-server host {{ server.ip }} {{ server.community }}
{% endfor %}
snmp ifmib ifindex persist
!
!
!
control-plane
!
!
line con 0
 exec-timeout 30 0
 logging synchronous
line aux 0
line vty 0 4
 exec-timeout 30 0
 password 7 141B1D0C050A
 transport input {{ vty_transport_input }}
!
ntp source {{ management_interface }}
ntp update-calendar
ntp server {{ ntp_server_ip }}
end
